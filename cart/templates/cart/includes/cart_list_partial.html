{% load humanize %}

{% if cart.cart.items %}
    {% for pack in cart %} 
    <div class="pack-container bg-white rounded-[2.5rem] shadow-soft border border-cream overflow-hidden" data-aos="fade-up">
        <div class="bg-base-200/50 px-8 py-4 flex justify-between items-center border-b border-cream">
            <h3 class="font-heading font-black uppercase italic text-charcoal">
                {{ pack.name }} <span class="text-primary ml-2">â‚¦{{ pack.total_price|intcomma }}</span>
            </h3>
            {% if pack.is_active %}
                <span class="badge badge-primary font-bold text-[10px] uppercase">Currently Adding To</span>
            {% else %}
                <button onclick="window.location.href='{% url 'switch_pack' pack.pack_id %}'" class="btn btn-ghost btn-xs font-bold uppercase text-gray-400">Switch to this pack</button>
            {% endif %}
        </div>

        <div class="p-4 space-y-4">
            {% for item in pack.items %}
            <div class="flex items-center group border border-cream/50" id="item-{{ pack.pack_id }}-{{ item.product.id }}">
                <div class="w-16 h-16 rounded-2xl overflow-hidden shrink-0 bg-base-200">
                    <img src="{{ item.product.image.url }}" class="w-full h-full object-cover">
                </div>

                <div class="grow px-4">
                    <h4 class="font-bold text-charcoal text-sm uppercase">{{ item.product.name }}</h4>
                    <p class="text-xs text-primary font-black">â‚¦{{ item.product.price }} <span class="text-gray-500">each</span></p>
                </div>

                <div class="flex items-center bg-base-200 rounded-full p-1 border border-cream">
                    <button onclick="updateCartPage('{{ item.product.id }}', 'decrease', '{{ pack.pack_id }}', this)" class="btn btn-circle btn-ghost btn-xs">âˆ’</button>
                    <span class="px-3 font-black text-sm" id="cart-qty-{{ pack.pack_id }}-{{ item.product.id }}">{{ item.quantity }}</span>
                    <button onclick="updateCartPage('{{ item.product.id }}', 'increase', '{{ pack.pack_id }}', this)" class="btn btn-circle btn-ghost btn-xs text-primary">+</button>
                </div>

                <button onclick="updateCartPage('{{ item.product.id }}', 'remove', '{{ pack.pack_id }}', this)" class="btn btn-ghost btn-circle text-gray-300 hover:text-error ml-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                </button>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endfor %}
{% else %}
<div class="text-center py-24 px-6 bg-white rounded-3xl shadow-soft">
    <div class="w-20 h-20 mx-auto mb-6 rounded-full bg-primary/10 flex items-center justify-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                d="M3 3h18M4 7h16M6 7v10a4 4 0 004 4h4a4 4 0 004-4V7" />
        </svg>
    </div>

    <h2 class="text-xl font-heading font-black uppercase mb-2">
        Your bag is empty
    </h2>

    <p class="text-base-content/60 max-w-sm mx-auto mb-8">
        No be today hunger dey win. Add some chops and letâ€™s sort you out.
    </p>

    <a href="{% url 'menu' %}"
        class="btn btn-primary rounded-full px-12 font-black uppercase italic shadow-soft hover:scale-105 transition-transform">
        Browse Menu
    </a>
</div>
<!-- 
<div class="text-center py-20 bg-white rounded-3xl shadow-soft">
    <div class="text-6xl mb-4">ðŸ¥¡</div>
    <h2 class="text-xl font-heading font-bold uppercase">Your bag is empty</h2>
    <p class="text-gray-500 mb-8">Levels dey wait! Go grab some chops.</p>
    <a href="{% url 'menu' %}" class="btn btn-primary rounded-full px-10 font-bold">Browse Menu</a>
</div> -->
{% endif %}